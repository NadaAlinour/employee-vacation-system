import{P as v,S as f}from"./SearchbarItem-519f9c31.js";import{_ as g,o as m,c as u,a as e,w as h,b as r,v as c,t as p,d as y,m as b,e as U,r as D,F as E,f as k,g as P,h as w}from"./index-ae2095e2.js";const T={props:["empID","employee","image"],data(){return{tempSkill:"",skills:[],url:this.image,profilePic:null,errMsg:"",successMsg:""}},watch:{image(l){this.url=l}},methods:{addSkill(l){l.key===","&&this.tempSkill&&(this.skills.push(this.tempSkill),this.tempSkill="")},handleFileChange(l){console.log("file change");const t=l.target.files[0];this.url=URL.createObjectURL(t),this.profilePic=l.target.files[0]},async submitForm(){console.log("submit for update employee is clicked"),this.successMsg="";var l=this.employee.vacationPerm=="true";let t=new FormData;this.profilePic!=null&&t.append("file",this.profilePic),t.append("Name",this.employee.name),t.append("Phone",this.employee.phone),t.append("Email",this.employee.email),t.append("Salary",this.employee.salary),t.append("IsVacationAllowed",l);const o={method:"PUT",headers:{Accept:"application/json",Authorization:`Bearer ${this.$store.state.token}`},body:t};try{const n=await(await fetch("http://localhost:5242/api/employee/"+this.empID,o)).json();(n.message!=""||n.message!=null)&&(this.successMsg=n.message),console.log(n)}catch(a){console.log(a.message)}},created(){console.log(this.employee)}}},B=e("h2",{class:"form-title"},"Update Employee",-1),I={class:"container-1a"},$=e("label",null,"Name",-1),C=e("label",null,"Phone",-1),V=e("label",null,"Email",-1),M=e("label",null,"Salary",-1),S={class:"btn-msg2"},A=e("button",{type:"submit"},"Update",-1),F={class:"success-msg-cont"},j={class:"err-msg-cont1"},x={class:"container-2a"},z={class:"perm-container"},N=e("div",{class:"perm-label"},[e("label",null,"Vacation Permission")],-1),G={id:"perm-group"},L={class:"radio-group"},R=e("label",null,"Yes",-1),H={class:"radio-group"},O=e("label",null,"No",-1),Y={class:"file-container2"},q=e("label",null,"Profile Picture",-1),J={class:"image-preview2"},K=["src"];function Q(l,t,o,a,n,d){return m(),u("div",{class:"modal-overlay",onClick:t[10]||(t[10]=s=>l.$emit("close-modal"))},[e("div",{class:"update-emp-modal",onClick:t[9]||(t[9]=h(()=>{},["stop"]))},[B,e("form",{class:"update-emp-form",onSubmit:t[7]||(t[7]=h((...s)=>d.submitForm&&d.submitForm(...s),["prevent"]))},[e("div",I,[$,r(e("input",{type:"text",placeholder:"Name","onUpdate:modelValue":t[0]||(t[0]=s=>o.employee.name=s)},null,512),[[c,o.employee.name]]),C,r(e("input",{type:"text",placeholder:"Phone","onUpdate:modelValue":t[1]||(t[1]=s=>o.employee.phone=s)},null,512),[[c,o.employee.phone]]),V,r(e("input",{type:"email",placeholder:"Email","onUpdate:modelValue":t[2]||(t[2]=s=>o.employee.email=s)},null,512),[[c,o.employee.email]]),M,r(e("input",{type:"number",placeholder:"500",min:"500",step:"100","onUpdate:modelValue":t[3]||(t[3]=s=>o.employee.salary=s)},null,512),[[c,o.employee.salary]]),e("div",S,[A,e("div",F,[e("h3",null,p(this.successMsg),1)]),e("div",j,[e("h3",null,p(this.errMsg),1)])])]),e("div",x,[e("div",z,[N,e("fieldset",G,[e("div",L,[r(e("input",{type:"radio",name:"perm-group","onUpdate:modelValue":t[4]||(t[4]=s=>o.employee.vacationPerm=s),value:"true"},null,512),[[y,o.employee.vacationPerm]]),R]),e("div",H,[r(e("input",{type:"radio",name:"perm-group","onUpdate:modelValue":t[5]||(t[5]=s=>o.employee.vacationPerm=s),value:"false"},null,512),[[y,o.employee.vacationPerm]]),O])])]),e("div",Y,[q,e("input",{type:"file",accept:".png, .jpg",onChange:t[6]||(t[6]=s=>d.handleFileChange(s))},null,32),e("div",J,[e("img",{src:n.url},null,8,K)])])])],32),e("button",{class:"exit-btn",type:"button",onClick:t[8]||(t[8]=s=>l.$emit("close-modal")),id:"upd-exit-btn"},"Exit")])])}const W=g(T,[["render",Q]]);const X={components:{PaginationItem:v,SearchbarItem:f,UpdateEmployeeModal:W},data(){return{employeesTemp:[],updateFlag:!1,currentEmployeeID:"",employees1:[],employeeToBeUpdated:{empID:"",name:"",email:"",image:"",hiredDate:"",phone:"",vacationPerm:"",salary:""},tempSrc:""}},computed:{...b(["employees"]),employees(){return this.$store.getters.employees}},async created(){await this.fetchEmployees(),console.log(this.employees1)},methods:{async fetchEmployees(){console.log(this.$store.state.token,"test");var l={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.$store.state.token}`}};try{var t;const o=await fetch("http://localhost:5242/api/employee",l);if(console.log(o.status),o.status===401){console.log("unauthorized action, navigate to unauthorized page"),this.$router.push("/401");return}const a=await o.json();this.employees1=a,console.log(this.employees1)}catch(o){console.log(o.message)}},...U(["fetchAllEmployees"]),async handleUpdate(l){this.currentEmployeeID="",console.log("update was clicked with employee id of:",l),this.updateFlag=!0,this.currentEmployeeID=l;var t={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.$store.state.token}`}};try{const o=await fetch("http://localhost:5242/api/employee/"+this.currentEmployeeID,t);console.log(o.status),o.status===401&&(console.log("action unauthorized, navigate to unauthorized page"),this.$router.push("/401"));const a=await o.json();console.log(a),this.employeeToBeUpdated.empID=a.employeeID,this.employeeToBeUpdated.name=a.name,this.employeeToBeUpdated.email=a.email,this.employeeToBeUpdated.image=a.image,this.employeeToBeUpdated.hiredDate=a.hiredDate,this.employeeToBeUpdated.phone=a.phone,this.employeeToBeUpdated.vacationPerm=a.isVacationAllowed,this.employeeToBeUpdated.salary=a.salary,console.log(this.employeeToBeUpdated.vacationPerm)}catch(o){console.log(o.message)}},handleDelete(l){console.log("deleting employee with id: "+l),fetch("http://localhost:5242/api/employee/"+l,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.$store.state.token}`}}).then(t=>{t.json(),console.log(t.status),t.status===401&&(console.log("action unauthorized, navigate to unauthorized page"),this.$router.push("/401"))}).then(t=>console.log(t)).catch(t=>console.log(t.message))}}},Z={class:"employee-info"},ee=e("h2",{class:"form-title"},"View Employees",-1),te={class:"employee-table"},oe=e("tr",null,[e("th",null,"ID"),e("th",null,"Image"),e("th",null,"Name"),e("th",null,"Date Hired"),e("th",null,"Phone"),e("th",null,"Email"),e("th",null,"Salary"),e("th",null,"Vacation Perm"),e("th"),e("th")],-1),le=["src"],se=["onClick"],ae=["onClick"],ne=e("div",{class:"trash-div"},null,-1),ie=[ne],pe={class:"update-emp-container"};function de(l,t,o,a,n,d){const s=D("UpdateEmployeeModal");return m(),u("div",Z,[ee,e("table",te,[oe,(m(!0),u(E,null,k(n.employees1,i=>(m(),u("tr",{key:i.EmployeeID},[e("td",null,p(i.employeeID),1),e("td",null,[e("img",{class:"user-pic",src:`data:image/png;base64,${i.image}`},null,8,le)]),e("td",null,p(i.name),1),e("td",null,p(i.hiredDate.split("T")[0]),1),e("td",null,p(i.phone),1),e("td",null,p(i.email),1),e("td",null,p(i.salary)+".00 EGP",1),e("td",null,p(i.isVacationAllowed==!0?"Allowed":"Not allowed"),1),e("td",null,[e("button",{class:"update-btn",onClick:_=>d.handleUpdate(i.employeeID)},"Update",8,se)]),e("td",{onClick:_=>d.handleDelete(i.employeeID)},ie,8,ae)]))),128))]),e("div",pe,[n.updateFlag?(m(),P(s,{key:0,onCloseModal:t[0]||(t[0]=i=>n.updateFlag=!1),empID:n.currentEmployeeID,employee:n.employeeToBeUpdated,image:`data:image/png;base64,${n.employeeToBeUpdated.image}`},null,8,["empID","employee","image"])):w("",!0)])])}const ce=g(X,[["render",de]]);export{ce as default};
